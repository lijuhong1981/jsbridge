!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).jsbridge={})}(this,(function(e){"use strict";const t={};function r(e,t,r){return"Expected "+r+" to be typeof "+t+", actual typeof was "+e}function n(e,t){e instanceof HTMLElement!=!1?function(e){if(e.parentNode&&e.parentNode.removeChild(e),e instanceof HTMLVideoElement){if(e.hlsPlayer&&(e.hlsPlayer.destroy(),delete e.hlsPlayer),e.flvPlayer){try{e.flvPlayer.unload(),e.flvPlayer.detachMediaElement()}catch(e){console.error(e)}e.flvPlayer.destroy(),delete e.flvPlayer}try{e.pause(),e.loop=!1,e.removeAttribute("src"),e.load()}catch(e){console.error(e)}}else e instanceof HTMLImageElement?e.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=":e instanceof HTMLCanvasElement&&(e.apngPlayer&&(e.apngPlayer.stop(),delete e.apngPlayer),e.gifPlayer&&(e.gifPlayer.stop(),delete e.gifPlayer),e.width=e.height=0)}(e):console.warn("The element must be instanceof HTMLElement.")}function o(){return!0}function s(e,t){if(!function(e){return void 0!==e.isDestroyed&&("function"==typeof e.isDestroyed?e.isDestroyed():e.isDestroyed)}(e)&&!e.isDestroying){(t=Object.assign({deleteProperty:!0,ignoreProperties:[],overwriteFunction:!0,releaseArray:!0,destroyHTMLElement:!0},t)).ignoreProperties.push("isDestroying","isDestroyed","destroy","undeletable"),e.isDestroying=!0;for(const o in e)if(!t.ignoreProperties||-1===t.ignoreProperties.indexOf(o)){try{const i=e[o];if(i){if(i.isCached||i.isProtected)continue;if("function"==typeof i&&!0===t.overwriteFunction?e[o]=r:Array.isArray(i)&&!0===t.releaseArray?i.length=0:i instanceof HTMLElement&&!0===t.destroyHTMLElement?n(e[o]):"object"==typeof i&&!0===t.deep&&("function"==typeof i.destroy?i.destroy():s(i,deep)),i.undeletable)continue}}catch(e){console.warn(e)}!0===t.deleteProperty&&delete e[o]}return e.isDestroyed=o,delete e.isDestroying,e}function r(){console.warn("The object isDestroyed, call function is invalid.",e)}console.warn("The object isDestroyed or isDestroying, repeated call destroyObject function are not required.",e)}t.typeOf={},t.defined=function(e,t){if(null==t)throw new Error(function(e){return e+" is required, actual value was undefined."}(e))},t.valid=function(e,t){if(null==(r=t)||"number"==typeof r&&isNaN(r))throw new Error(function(e){return e+" is required, actual value was invalid."}(e));var r},t.typeOf.func=function(e,t){if("function"!=typeof t)throw new Error(r(typeof t,"function",e))},t.typeOf.string=function(e,t){if("string"!=typeof t)throw new Error(r(typeof t,"string",e))},t.typeOf.number=function(e,t){if("number"!=typeof t)throw new Error(r(typeof t,"number",e))},t.typeOf.number.lessThan=function(e,r,n){if(t.typeOf.number(e,r),r>=n)throw new Error("Expected "+e+" to be less than "+n+", actual value was "+r)},t.typeOf.number.lessThanOrEquals=function(e,r,n){if(t.typeOf.number(e,r),r>n)throw new Error("Expected "+e+" to be less than or equal to "+n+", actual value was "+r)},t.typeOf.number.greaterThan=function(e,r,n){if(t.typeOf.number(e,r),r<=n)throw new Error("Expected "+e+" to be greater than "+n+", actual value was "+r)},t.typeOf.number.greaterThanOrEquals=function(e,r,n){if(t.typeOf.number(e,r),r<n)throw new Error("Expected "+e+" to be greater than or equal to"+n+", actual value was "+r)},t.typeOf.number.equals=function(e,r,n,o){if(t.typeOf.number(e,n),t.typeOf.number(r,o),n!==o)throw new Error(e+" must be equal to "+r+", the actual values are "+n+" and "+o)},t.typeOf.object=function(e,t){if("object"!=typeof t)throw new Error(r(typeof t,"object",e))},t.typeOf.bool=function(e,t){if("boolean"!=typeof t)throw new Error(r(typeof t,"boolean",e))},t.typeOf.array=function(e,t){if(!1===Array.isArray(t))throw new Error(r(typeof t,"array",e))},t.typeOf.integer=function(e,t){if(!1===Number.isSafeInteger(t))throw new Error(r(typeof t,"integer",e))},t.typeOf.integer.lessThan=function(e,r,n){if(t.typeOf.integer(e,r),r>=n)throw new Error("Expected "+e+" to be less than "+n+", actual value was "+r)},t.typeOf.integer.lessThanOrEquals=function(e,r,n){if(t.typeOf.integer(e,r),r>n)throw new Error("Expected "+e+" to be less than or equal to "+n+", actual value was "+r)},t.typeOf.integer.greaterThan=function(e,r,n){if(t.typeOf.integer(e,r),r<=n)throw new Error("Expected "+e+" to be greater than "+n+", actual value was "+r)},t.typeOf.integer.greaterThanOrEquals=function(e,r,n){if(t.typeOf.integer(e,r),r<n)throw new Error("Expected "+e+" to be greater than or equal to"+n+", actual value was "+r)},t.typeOf.integer.equals=function(e,r,n,o){if(t.typeOf.integer(e,n),t.typeOf.integer(r,o),n!==o)throw new Error(e+" must be equal to "+r+", the actual values are "+n+" and "+o)},t.instanceOf=function(e,t,n){if(t instanceof n==!1)throw new Error(r(!1,n.name,e))},t.equals=function(e,r,n){if(t.isValid(r),t.isValid(n),r!==n)throw new Error("Expected "+e+" to be equal "+n+", actual value was "+r)};class i{isDestroyed(){return!1}onDestroy(...e){}destroy(...e){return this.isDestroyed()?console.warn("This object was destroyed.",this):this.isDestroying?console.warn("This object is destroying.",this):(this.onDestroy(...e),s(this)),this}}function a(e){return Array.isArray(e)}function c(e){return"string"==typeof e}class l extends i{constructor(){super(),this._listenersMap=new Map}get numberOfListeners(){return this._listenersMap.size}get listeners(){const e=[],t=this._listenersMap.values();for(const r of t)e.push(r.callback);return e}hasEventListener(e){return this._listenersMap.has(e)}addEventListener(e,r={}){t.typeOf.func("callback",e);let n=this._listenersMap.get(e);return n?n.options=r:(n={callback:e,options:r,removeFunc:()=>{this.removeEventListener(e)}},this._listenersMap.set(e,n)),n.removeFunc}removeEventListener(e){return t.typeOf.func("callback",e),this._listenersMap.delete(e)}on(e,t){return this.addEventListener(e,t)}off(e){return this.removeEventListener(e)}once(e,t){return this.addEventListener(e,{once:!0,scope:t})}clear(){return this._listenersMap.clear(),this}raiseEvent(...e){const t=this._listenersMap.values();for(const e of t){const t=e.options,r=e.callback;r.apply(t.scope,arguments),t.once&&this._listenersMap.delete(r)}return this}onDestroy(){this.clear()}}function u(e,t,r,n){let o=e.get(t);o||(o=new l,e.set(t,o)),o.addEventListener(r,n)}function d(e,t,r){const n=e.get(t);n&&(r?n.removeEventListener(r):(e.delete(t),n.destroy()))}class f extends i{constructor(){super(),this._events=new Map}addEventListener(e,r,n){return t.valid("type",e),t.typeOf.func("callback",r),c(e)&&e.match(/\s+/)&&(e=e.split(/\s+/)),a(e)?e.forEach((e=>{u(this._events,e,r,n)})):u(this._events,e,r,n),this}removeEventListener(e,r){return t.valid("type",e),c(e)&&e.match(/\s+/)&&(e=e.split(/\s+/)),a(e)?e.forEach((e=>{d(this._events,e,r)})):d(this._events,e,r),this}removeAllEventListeners(){return this._events.forEach((function(e){e.destroy()})),this._events.clear(),this}get numberOfEvents(){return this._events.size}numberOfListeners(e){t.valid("type",e);const r=this._events.get(e);return r?r.numberOfListeners:0}hasEventListener(e){t.valid("type",e);const r=this._events.get(e);return r&&r.numberOfListeners>0}getEventListeners(e){t.valid("type",e);const r=this._events.get(e);return r&&r.listeners}dispatch(e,...r){t.valid("type",e);const n=this._events.get(e);return n&&n.raiseEvent(...r),this}dispatchEvent(e,r){t.typeOf.object("event",e),t.valid("event.type",e.type),e.owner||(e.owner=r||this);const n=this._events.get(e.type);return n&&n.raiseEvent(e),this}onDestroy(){this.removeAllEventListeners()}}for(var y,p=[],h=0;h<256;++h)p.push((h+256).toString(16).slice(1));var g=new Uint8Array(16);function b(){if(!y&&!(y="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return y(g)}var v={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function w(e,t,r){if(v.randomUUID&&!t&&!e)return v.randomUUID();var n=(e=e||{}).random||(e.rng||b)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(e,t=0){return(p[e[t+0]]+p[e[t+1]]+p[e[t+2]]+p[e[t+3]]+"-"+p[e[t+4]]+p[e[t+5]]+"-"+p[e[t+6]]+p[e[t+7]]+"-"+p[e[t+8]]+p[e[t+9]]+"-"+p[e[t+10]]+p[e[t+11]]+p[e[t+12]]+p[e[t+13]]+p[e[t+14]]+p[e[t+15]]).toLowerCase()}(n)}const m={},E=new l,O=new class extends i{constructor(){super(),this._dispatcher=new f}addListener(e,t,r){return this._dispatcher.addEventListener(e,t,r),this}on(e,t,r){return this.addListener(e,t,r)}once(e,t,r){return this.addListener(e,t,{once:!0,scope:r}),this}removeListener(e,t){return this._dispatcher.removeEventListener(e,t),this}off(e,t){return this.removeListener(e,t)}removeAllListeners(){return this._dispatcher.removeAllEventListeners(),this}hasListener(e){return this._dispatcher.hasEventListener(e)}getListeners(e){return this._dispatcher.getEventListeners(e)}get numberOfEvents(){return this._dispatcher.numberOfEvents}numberOfListeners(e){return this._dispatcher.numberOfListeners(e)}emit(e,...t){return this._dispatcher.dispatch(e,...t),this}emitEvent(e,t){return this._dispatcher.dispatchEvent(e,t||this),this}onDestroy(){this._dispatcher.destroy()}},L=Object.freeze({VERBOSE:2,DEBUG:3,INFO:4,WARN:5,ERROR:6,ASSERT:7});function A(){return window.jsbridgeInterface?"function"==typeof window.jsbridgeInterface.onBridgeMessage||(console.warn("the window.jsbridgeInterface.onBridgeMessage is not function.",window.jsbridgeInterface),!1):(console.warn("not found the window.jsbridgeInterface object."),!1)}function _(e,r){if(t.defined("message",e),t.typeOf.string("type",e.type),!A())return!1;e.id||(e.id=w()),e.body||(e.body={}),"function"==typeof r&&(m[e.id]=r);const n=JSON.stringify(e);return console.log("postMessageToApp:",n),window.jsbridgeInterface.onBridgeMessage(n),e.id}window.onBridgeMessage=function(e){console.log("onReceiveMessageFromApp:",e);const t=JSON.parse(e);if("messageCallback"===t.type||"methodCallback"===t.type){const e=m[t.id];"function"==typeof e&&t.body&&e(t.body),t.persistCallback||delete m[t.id]}else if("logMessage"===t.type){switch(t.body.priority){case L.DEBUG:t.body.error?console.debug(t.body.tag,t.body.msg,t.body.error):console.log(t.body.tag,t.body.msg);break;case L.INFO:t.body.error?console.info(t.body.tag,t.body.msg,t.body.error):console.log(t.body.tag,t.body.msg);break;case L.WARN:t.body.error?console.warn(t.body.tag,t.body.msg,t.body.error):console.log(t.body.tag,t.body.msg);break;case L.ERROR:t.body.error?console.error(t.body.tag,t.body.msg,t.body.error):console.log(t.body.tag,t.body.msg);break;default:t.body.error?console.log(t.body.tag,t.body.msg,t.body.error):console.log(t.body.tag,t.body.msg)}}else E.raiseEvent(t),O.emit(t.type,t.body)},e.callMethod=function(e,r={},n){return t.typeOf.string("method",e),_({type:"callMethod",body:{method:e,params:r}},n)},e.checkValid=A,e.onEvent=O,e.onMessage=E,e.postMessage=_}));
