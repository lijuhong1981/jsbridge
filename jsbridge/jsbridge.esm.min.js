const e={};function t(e,t,r){return"Expected "+r+" to be typeof "+t+", actual typeof was "+e}function r(e,t){e instanceof HTMLElement!=!1?function(e){if(e.parentNode&&e.parentNode.removeChild(e),e instanceof HTMLVideoElement){if(e.hlsPlayer&&(e.hlsPlayer.destroy(),delete e.hlsPlayer),e.flvPlayer){try{e.flvPlayer.unload(),e.flvPlayer.detachMediaElement()}catch(e){console.error(e)}e.flvPlayer.destroy(),delete e.flvPlayer}try{e.pause(),e.loop=!1,e.removeAttribute("src"),e.load()}catch(e){console.error(e)}}else e instanceof HTMLImageElement?e.src="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs=":e instanceof HTMLCanvasElement&&(e.apngPlayer&&(e.apngPlayer.stop(),delete e.apngPlayer),e.gifPlayer&&(e.gifPlayer.stop(),delete e.gifPlayer),e.width=e.height=0)}(e):console.warn("The element must be instanceof HTMLElement.")}function n(){return!0}function s(e,t){if(!function(e){return void 0!==e.isDestroyed&&("function"==typeof e.isDestroyed?e.isDestroyed():e.isDestroyed)}(e)&&!e.isDestroying){(t=Object.assign({deleteProperty:!0,ignoreProperties:[],overwriteFunction:!0,releaseArray:!0,destroyHTMLElement:!0},t)).ignoreProperties.push("isDestroying","isDestroyed","destroy","undeletable"),e.isDestroying=!0;for(const n in e)if(!t.ignoreProperties||-1===t.ignoreProperties.indexOf(n)){try{const i=e[n];if(i){if(i.isCached||i.isProtected)continue;if("function"==typeof i&&!0===t.overwriteFunction?e[n]=o:Array.isArray(i)&&!0===t.releaseArray?i.length=0:i instanceof HTMLElement&&!0===t.destroyHTMLElement?r(e[n]):"object"==typeof i&&!0===t.deep&&("function"==typeof i.destroy?i.destroy():s(i,deep)),i.undeletable)continue}}catch(e){console.warn(e)}!0===t.deleteProperty&&delete e[n]}return e.isDestroyed=n,delete e.isDestroying,e}function o(){console.warn("The object isDestroyed, call function is invalid.",e)}console.warn("The object isDestroyed or isDestroying, repeated call destroyObject function are not required.",e)}e.typeOf={},e.defined=function(e,t){if(null==t)throw new Error(function(e){return e+" is required, actual value was undefined."}(e))},e.valid=function(e,t){if(null==(r=t)||"number"==typeof r&&isNaN(r))throw new Error(function(e){return e+" is required, actual value was invalid."}(e));var r},e.typeOf.func=function(e,r){if("function"!=typeof r)throw new Error(t(typeof r,"function",e))},e.typeOf.string=function(e,r){if("string"!=typeof r)throw new Error(t(typeof r,"string",e))},e.typeOf.number=function(e,r){if("number"!=typeof r)throw new Error(t(typeof r,"number",e))},e.typeOf.number.lessThan=function(t,r,n){if(e.typeOf.number(t,r),r>=n)throw new Error("Expected "+t+" to be less than "+n+", actual value was "+r)},e.typeOf.number.lessThanOrEquals=function(t,r,n){if(e.typeOf.number(t,r),r>n)throw new Error("Expected "+t+" to be less than or equal to "+n+", actual value was "+r)},e.typeOf.number.greaterThan=function(t,r,n){if(e.typeOf.number(t,r),r<=n)throw new Error("Expected "+t+" to be greater than "+n+", actual value was "+r)},e.typeOf.number.greaterThanOrEquals=function(t,r,n){if(e.typeOf.number(t,r),r<n)throw new Error("Expected "+t+" to be greater than or equal to"+n+", actual value was "+r)},e.typeOf.number.equals=function(t,r,n,s){if(e.typeOf.number(t,n),e.typeOf.number(r,s),n!==s)throw new Error(t+" must be equal to "+r+", the actual values are "+n+" and "+s)},e.typeOf.object=function(e,r){if("object"!=typeof r)throw new Error(t(typeof r,"object",e))},e.typeOf.bool=function(e,r){if("boolean"!=typeof r)throw new Error(t(typeof r,"boolean",e))},e.typeOf.array=function(e,r){if(!1===Array.isArray(r))throw new Error(t(typeof r,"array",e))},e.typeOf.integer=function(e,r){if(!1===Number.isSafeInteger(r))throw new Error(t(typeof r,"integer",e))},e.typeOf.integer.lessThan=function(t,r,n){if(e.typeOf.integer(t,r),r>=n)throw new Error("Expected "+t+" to be less than "+n+", actual value was "+r)},e.typeOf.integer.lessThanOrEquals=function(t,r,n){if(e.typeOf.integer(t,r),r>n)throw new Error("Expected "+t+" to be less than or equal to "+n+", actual value was "+r)},e.typeOf.integer.greaterThan=function(t,r,n){if(e.typeOf.integer(t,r),r<=n)throw new Error("Expected "+t+" to be greater than "+n+", actual value was "+r)},e.typeOf.integer.greaterThanOrEquals=function(t,r,n){if(e.typeOf.integer(t,r),r<n)throw new Error("Expected "+t+" to be greater than or equal to"+n+", actual value was "+r)},e.typeOf.integer.equals=function(t,r,n,s){if(e.typeOf.integer(t,n),e.typeOf.integer(r,s),n!==s)throw new Error(t+" must be equal to "+r+", the actual values are "+n+" and "+s)},e.instanceOf=function(e,r,n){if(r instanceof n==!1)throw new Error(t(!1,n.name,e))},e.equals=function(t,r,n){if(e.isValid(r),e.isValid(n),r!==n)throw new Error("Expected "+t+" to be equal "+n+", actual value was "+r)};class o{isDestroyed(){return!1}onDestroy(...e){}destroy(...e){return this.isDestroyed()?console.warn("This object was destroyed.",this):this.isDestroying?console.warn("This object is destroying.",this):(this.onDestroy(...e),s(this)),this}}function i(e){return Array.isArray(e)}function a(e){return"string"==typeof e}class c extends o{constructor(){super(),this._listenersMap=new Map}get numberOfListeners(){return this._listenersMap.size}get listeners(){const e=[],t=this._listenersMap.values();for(const r of t)e.push(r.callback);return e}hasEventListener(e){return this._listenersMap.has(e)}addEventListener(t,r={}){e.typeOf.func("callback",t);let n=this._listenersMap.get(t);return n?n.options=r:(n={callback:t,options:r,removeFunc:()=>{this.removeEventListener(t)}},this._listenersMap.set(t,n)),n.removeFunc}removeEventListener(t){return e.typeOf.func("callback",t),this._listenersMap.delete(t)}on(e,t){return this.addEventListener(e,t)}off(e){return this.removeEventListener(e)}once(e,t){return this.addEventListener(e,{once:!0,scope:t})}clear(){return this._listenersMap.clear(),this}raiseEvent(...e){const t=this._listenersMap.values();for(const e of t){const t=e.options,r=e.callback;r.apply(t.scope,arguments),t.once&&this._listenersMap.delete(r)}return this}onDestroy(){this.clear()}}function u(e,t,r,n){let s=e.get(t);s||(s=new c,e.set(t,s)),s.addEventListener(r,n)}function l(e,t,r){const n=e.get(t);n&&(r?n.removeEventListener(r):(e.delete(t),n.destroy()))}class f extends o{constructor(){super(),this._events=new Map}addEventListener(t,r,n){return e.valid("type",t),e.typeOf.func("callback",r),a(t)&&t.match(/\s+/)&&(t=t.split(/\s+/)),i(t)?t.forEach((e=>{u(this._events,e,r,n)})):u(this._events,t,r,n),this}removeEventListener(t,r){return e.valid("type",t),a(t)&&t.match(/\s+/)&&(t=t.split(/\s+/)),i(t)?t.forEach((e=>{l(this._events,e,r)})):l(this._events,t,r),this}removeAllEventListeners(){return this._events.forEach((function(e){e.destroy()})),this._events.clear(),this}get numberOfEvents(){return this._events.size}numberOfListeners(t){e.valid("type",t);const r=this._events.get(t);return r?r.numberOfListeners:0}hasEventListener(t){e.valid("type",t);const r=this._events.get(t);return r&&r.numberOfListeners>0}getEventListeners(t){e.valid("type",t);const r=this._events.get(t);return r&&r.listeners}dispatch(t,...r){e.valid("type",t);const n=this._events.get(t);return n&&n.raiseEvent(...r),this}dispatchEvent(t,r){e.typeOf.object("event",t),e.valid("event.type",t.type),t.owner||(t.owner=r||this);const n=this._events.get(t.type);return n&&n.raiseEvent(t),this}onDestroy(){this.removeAllEventListeners()}}for(var d,p=[],h=0;h<256;++h)p.push((h+256).toString(16).slice(1));var y=new Uint8Array(16);function v(){if(!d&&!(d="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return d(y)}var g={randomUUID:"undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function w(e,t,r){if(g.randomUUID&&!t&&!e)return g.randomUUID();var n=(e=e||{}).random||(e.rng||v)();return n[6]=15&n[6]|64,n[8]=63&n[8]|128,function(e,t=0){return(p[e[t+0]]+p[e[t+1]]+p[e[t+2]]+p[e[t+3]]+"-"+p[e[t+4]]+p[e[t+5]]+"-"+p[e[t+6]]+p[e[t+7]]+"-"+p[e[t+8]]+p[e[t+9]]+"-"+p[e[t+10]]+p[e[t+11]]+p[e[t+12]]+p[e[t+13]]+p[e[t+14]]+p[e[t+15]]).toLowerCase()}(n)}const b={},m=new c,E=new class extends o{constructor(){super(),this._dispatcher=new f}addListener(e,t,r){return this._dispatcher.addEventListener(e,t,r),this}on(e,t,r){return this.addListener(e,t,r)}once(e,t,r){return this.addListener(e,t,{once:!0,scope:r}),this}removeListener(e,t){return this._dispatcher.removeEventListener(e,t),this}off(e,t){return this.removeListener(e,t)}removeAllListeners(){return this._dispatcher.removeAllEventListeners(),this}hasListener(e){return this._dispatcher.hasEventListener(e)}getListeners(e){return this._dispatcher.getEventListeners(e)}get numberOfEvents(){return this._dispatcher.numberOfEvents}numberOfListeners(e){return this._dispatcher.numberOfListeners(e)}emit(e,...t){return this._dispatcher.dispatch(e,...t),this}emitEvent(e,t){return this._dispatcher.dispatchEvent(e,t||this),this}onDestroy(){this._dispatcher.destroy()}};function O(){return window.jsbridgeInterface?"function"==typeof window.jsbridgeInterface.onBridgeMessage||(console.warn("the window.jsbridgeInterface.onBridgeMessage is not function.",window.jsbridgeInterface),!1):(console.warn("not found the window.jsbridgeInterface object."),!1)}function L(t,r){if(e.defined("message",t),e.typeOf.string("type",t.type),!O())return!1;t.id||(t.id=w()),t.body||(t.body={}),"function"==typeof r&&(b[t.id]=r);const n=JSON.stringify(t);return console.log("postMessageToApp:",n),window.jsbridgeInterface.onBridgeMessage(n),t.id}function _(t,r={},n){return e.typeOf.string("method",t),L({type:"callMethod",body:{method:t,params:r}},n)}window.onBridgeMessage=function(e){console.log("onReceiveMessageFromApp:",e);const t=JSON.parse(e);if("messageCallback"===t.type||"methodCallback"===t.type){const e=b[t.id];"function"==typeof e&&t.body&&e(t.body),t.persistCallback||delete b[t.id]}else m.raiseEvent(t),E.emit(t.type,t.body)};export{_ as callMethod,O as checkValid,E as onEvent,m as onMessage,L as postMessage};
