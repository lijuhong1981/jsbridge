<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>demo</title>
    <style>
        html,
        body {
            /* set margin to 0 and overflow to hidden, to go fullscreen */
            margin: 0;
            overflow: auto;
            width: 100%;
            height: 100%;
            background-color: #ffffff;
        }

        #response-content {
            width: 100%;
            height: 100%;
            padding: 5em;
        }
    </style>
</head>

<body>
    <script src="js/dat.gui.min.js"></script>
    <script src="../jsbridge/jsbridge.js"></script>
    <pre id="response-content"></pre>
    <img id="image-preview" />
    <script>
        const responseContent = document.getElementById("response-content");
        const imagePreview = document.getElementById("image-preview");

        const uiParams = {
            type: 'type',
            method: 'methodTest',
            key1: 'key1',
            value1: 'value1',
            key2: 'key2',
            value2: 'value2',
            postMessage: function () {
                const body = {};
                body[uiParams.key1] = uiParams.value1;
                body[uiParams.key2] = uiParams.value2;
                jsbridge.postMessage({
                    type: uiParams.type,
                    body
                });
            },
            callMethod: function () {
                const params = {};
                params[uiParams.key1] = uiParams.value1;
                params[uiParams.key2] = uiParams.value2;
                jsbridge.callMethod(uiParams.method, params, function (result) {
                    console.log('onCallback:', result);
                    responseContent.innerText = JSON.stringify(result);
                });
            },
            text: 'text',
            showToast: function () {
                jsbridge.callMethod('showToast', {
                    text: uiParams.text,
                });
            },
            title: "title",
            content: "content",
            showPositiveButton: true,
            positiveButtonName: "确定",
            showNegativeButton: false,
            negativeButtonName: "取消",
            showNeutralButton: false,
            neutralButtonName: "中立",
            showAlertDialog: function () {
                // 显示对话框
                jsbridge.callMethod('showAlertDialog', {
                    title: uiParams.title, //对话框标题
                    content: uiParams.content, //对话框内容
                    showPositiveButton: uiParams.showPositiveButton, //是否显示确定按钮
                    positiveButtonName: uiParams.positiveButtonName, //确定按钮名称
                    showNegativeButton: uiParams.showNegativeButton, //是否显示否定按钮
                    negativeButtonName: uiParams.negativeButtonName, //否定按钮名称
                    showNeutralButton: uiParams.showNeutralButton, //是否显示中立按钮
                    neutralButtonName: uiParams.neutralButtonName, //中立按钮名称
                }, function (result) {
                    console.log('showAlertDialog result:', result);
                    responseContent.innerText = JSON.stringify(result, null, 2);
                });
            },
            getAppInfo: function () {
                // 获取APP信息
                jsbridge.callMethod('getAppInfo', {}, function (result) {
                    console.log('getAppInfo result:', result);
                    responseContent.innerText = JSON.stringify(result, null, 2);
                });
            },
            getDeviceInfo: function () {
                // 获取设备信息
                jsbridge.callMethod('getDeviceInfo', {}, function (result) {
                    console.log('getDeviceInfo result:', result);
                    responseContent.innerText = JSON.stringify(result, null, 2);
                });
            },
            getDisplayInfo: function () {
                // 获取屏幕信息
                jsbridge.callMethod('getDisplayInfo', {}, function (result) {
                    console.log('getDisplayInfo result:', result);
                    responseContent.innerText = JSON.stringify(result, null, 2);
                });
            },
            phoneNumber: "10086",
            dialPhone: function () {
                // 打开电话拨打界面，因为并不直接拨打电话，故不需要APP权限支持
                jsbridge.callMethod('dialPhone', {
                    phoneNumber: uiParams.phoneNumber,
                });
            },
            callPhone: function () {
                // 拨打电话，需要APP权限支持
                jsbridge.callMethod('callPhone', {
                    phoneNumber: uiParams.phoneNumber,
                });
            },
            takePhoto: function () {
                // 调用相机拍照，成功后会返回一个图片url，image.src可直接使用
                jsbridge.callMethod('takePhoto', {}, function (result) {
                    console.log('takePhoto result:', result);
                    responseContent.innerText = JSON.stringify(result, null, 2);
                    if (result.success) {
                        imagePreview.src = result.data.url;
                    }
                });
            },
            force: false,
            exitApp: function () {
                // 退出APP
                jsbridge.callMethod('exitApp', {
                    force: uiParams.force,
                });
            }
        };

        jsbridge.onMessage.addEventListener(function (message) {
            console.log("onMessage:", message);
        });

        const gui = new dat.GUI();
        gui.open();

        // gui.add(uiParams, 'type');
        gui.add(uiParams, 'method');
        gui.add(uiParams, 'key1');
        gui.add(uiParams, 'value1');
        gui.add(uiParams, 'key2');
        gui.add(uiParams, 'value2');
        // gui.add(uiParams, 'postMessage');
        gui.add(uiParams, 'callMethod');
        gui.add(uiParams, 'text');
        gui.add(uiParams, 'showToast');
        gui.add(uiParams, 'showPositiveButton');
        gui.add(uiParams, 'positiveButtonName');
        gui.add(uiParams, 'showNegativeButton');
        gui.add(uiParams, 'negativeButtonName');
        gui.add(uiParams, 'showNeutralButton');
        gui.add(uiParams, 'neutralButtonName');
        gui.add(uiParams, "showAlertDialog");
        gui.add(uiParams, 'getAppInfo');
        gui.add(uiParams, 'getDeviceInfo');
        gui.add(uiParams, 'getDisplayInfo');
        gui.add(uiParams, 'dialPhone');
        gui.add(uiParams, 'callPhone');
        gui.add(uiParams, 'takePhoto');
        gui.add(uiParams, 'force');
        gui.add(uiParams, 'exitApp');
    </script>
</body>

</html>